---
layout: single
title: "#5. [고전 C++ 가이드] 유효 범위"
categories: "classic-cpp-guide"
tag: ["cpp"]
author_profile: false
sidebar: 
    nav: "docs"
---

> * 이름의 유효 범위는 짧게 유지하라.
> * 블록을 이용하여 변수의 유효 범위를 짧게 유지하라.

**개요**

전역 개체의 경우에는 전체 범위에 영향을 주며, 그렇치 않은 경우는 블록문 범위 내에서만 영향을 줍니다.(클래스, 함수, 네임스페이스, 열거형, `try-catch()` 등) 만약 이름이 동일한 경우에는 가까운 블록에 정의된 것이 먼곳의 것을 가립니다. 

다음은 전역변수, 함수의 지역변수, 블록내에 정의된 변수가 이름이 동일할 경우 어떻게 사용될 수 있는지 보여주는 예입니다. 

```cpp
namespace {
    int x = 1; // 전역 변수. namespace 내에 있어 현 파일에서만 접근 가능
}

TEST(TestClassicCpp, Scope) {
    EXPECT_TRUE(x == 1); // 전역 변수
    int x = 2; 
    EXPECT_TRUE(x == 2); // 지역변수가 전역 x를 가림
    {
        int x = 3;
        EXPECT_TRUE(x == 3); // 블록이 지역 x를 가림
        ::x = 10; // :: 붙여 강제로 전역 접근
    } 
    EXPECT_TRUE(x == 2); // 지역 변수
    EXPECT_TRUE(::x == 10); // 전역 변수
}
```

**이름의 유효 범위가 짧으면 좋은 이유**

프로젝트 규모가 커지면, 서로 다른 영역에서 동일한 이름을 사용하게 될 확률이 높습니다. 특히 직관적이고 좋은 이름일수록요. 이름이 서로 충돌나거나 가리지 않도록 이름의 유효 범위를 짧게 유지하는게 좋습니다.

특히 이름 충돌시 매크로가 관여되면 대환장 파티가 열릴 수 있습니다.([매크로 참고](https://tango1202.github.io/classic-cpp-guide/classic-cpp-guide-macro/))

**블록을 활용한 유효 범위 통제**

정의한 곳과 사용하는 곳이 가깝게 있는 것이 좋습니다. 특히 함수 앞 부분에 변수 정의를 몰아서 해두는 건 좋지 않습니다. 나중에 위아래 스크롤 하시기 바빠질 수 있거든요.(변수명이 뭐였지? 자료형이 뭐였지? 그냥 헝가리언 표기를 할까? 언제 초기화 됐지? 언제 값이 바뀌지?) 
 
하기와 같이 많은 변수를 사용하는 함수라면,

```cpp
void f() {
    int a;
    int b;
    ...
    int z;

    // a~z를 사용하는 코드들
}
```

하기처럼 유효범위를 짧게 해서 블록화 해보세요.

```cpp

void f() {
    {
        int a;
        int b;
        // a와 b만 사용하는 코드들
    }
    {
        int c;
        int d;
        // c와 d만 사용하는 코드들
    }
}
```

깔끔하게 나눠졌다면, 각 블록을 함수화 하시길 바랍니다.
