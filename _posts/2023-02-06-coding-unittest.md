---
layout: single
title: "#6. 좋은 단위 테스트 작성하기(작성중)"
categories: "coding"
tag: ["코딩", "TDD", "단위 테스트"]
author_profile: false
sidebar: 
    nav: "docs"
---

단위 테스트란 하나의 기능 단위를 테스트하는 것을 말합니다. 혹은 단위 기능들을 복합하여 다시 하나의 단위 테스트를 만들 수도 있습니다.

좋은 단위 테스트는 다음의 조건을 갖춰야 합니다.

1. 독립성

    다른 테스트에 의존성이 없어야 합니다. 특정 테스트를 단독 실행해도 통과할 수 있도록 구성하세요. 테스트 복잡성 뿐만 아니라 기능 코드의 복잡성을 낮추고 안정성을 향상시킵니다.

2. 반복성

    여러번 반복해서 실행해도 같은 결과가 나와야 합니다.

3. 중복 제거

    중복된 테스트를 하지 마세요. 하기에 홀수끼리 더하면 짝수가 되는걸 확인할 필요가 있을까요? 꼭 필요한 테스트만 작성하시고, 불필요한 테스트는 없어야 합니다. 코드량이 많아지면, 유지보수 부하만 늘어나니까요.

    ```cpp
    TEST(TestPlus, Test1) {
        // 1 + 2 == 3을 테스트합니다. 좋습니다. 
        EXPECT_TRUE(Plus::Run(1, 2) == 3); 

        // 2 + 1 == 3을 테스트합니다. 인자를 바꿔도 정상동작인지 확인하니, 좋습니다. 
        EXPECT_TRUE(Plus::Run(2, 1) == 3); 

        // 무조건 3을 리턴할 수 있으니, 다른 결과값을 확인합니다. 좋습니다. 
        EXPECT_TRUE(Plus::Run(2, 4) == 6)    

        // 홀수끼리 더하면 짝수가 나오는지 확인합니다. 글쎄요. 필요할까요? 
        EXPECT_TRUE(Plus::Run(1, 3) == 4)
    }    
    ```
    
또한

1. 테스트 코드 자체를 최대한 간결하게 만들어야 합니다. 

    테스트를 작성하다가 지치면 안됩니다. 이건 테스트 하려는 기능의 사용법이 복잡하고 악취가 난다는 뜻입니다. 테스트를 복잡하게 만들지 말고, 기능 구현을 리팩토링 하세요. facade나 유틸리티 클래스 작성을 권장합니다.
테스트 코드는 최대한 짧아야 하고, 작성 시간도 짧아야 합니다.

2. 테스트 코드 자체가 기능 사용 설명 예제가 될 수 있어야 합니다.

    테스트 코드는 기능의 사용법을 알려줄 수 있어야 합니다.

3. 좋은 이름을 사용해서 테스트명으로 무엇을 하는지 설명할 수 있어야 합니다.

   테스트할 기능명 + 시나리오 + 예상동작으로 이름을 짓는게 좋습니다.

4. 빠르게 테스트 되어야 합니다.

    자동화된 단위 테스트가 느려지면, 점점 테스트를 안하게 될 수 있습니다. 리팩토링의 신호입니다. 속도 개선을 시작하세요. 혹은 프로젝트를 모듈 단위로 쪼개세요. 백만라인 되버립니다.

5. 특정 인프라 시스템 종속성이 없어야 합니다.

    예를 들어 인프라 접근을 추상화하고 strategy 패턴으로 추상화하여 테스트용 개체를 만들어 테스트 합니다.

6. 가까스로 테스트를 통과해야 합니다.
    테스트와 상관없는 불필요한 코드가 테스트에 작성되면 안됩니다. 또한 불필요한 정보가 노출 되어서도 안됩니다. 기능 예제를 오해할 수 있고 테스트의 의도가 불분명 해집니다.
    
    add(0) // add 가 잘 되는지 확인
   add(76) // add 가 잘 되는지 확인. 근데 왜 하필 76이지?

잊지마세요!!!

1. 독립성, 반복성, 중복 제거
